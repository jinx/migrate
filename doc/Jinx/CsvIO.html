<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: Jinx::CsvIO</title>
<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../Jinx.html" title="Jinx (module)">Jinx</a></span></span>
     &raquo; 
    <span class="title">CsvIO</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Jinx::CsvIO
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Jinx::CsvIO</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">Enumerable</dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/jinx/csv/csvio.rb<span class="defines">,<br />
  lib/jinx/csv/joiner.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
CsvIO reads or writes CSV records. This class wraps a FasterCSV with the
following modifications:
</p>
<ul>
<li><p>
relax the date parser to allow dd/mm/yyyy dates
</p>
</li>
<li><p>
don&#8217;t convert integer text with a leading zero to an octal number
</p>
</li>
<li><p>
allow one custom converter with different semantics: if the converter block
call returns nil, then continue conversion, otherwise return the converter
result. This differs from FasterCSV converter semantics which calls
converters as long the result equals the input field value. The CsvIO
converter semantics supports converters that intend a String result to be
the converted result.
</p>
</li>
</ul>
<p>
CsvIO is Enumerable, but does not implement the complete Ruby IO interface.
</p>


  </div>
</div>
<div class="tags">
  
</div><h2>Defined Under Namespace</h2>
<p class="children">
   
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="CsvIO/Joiner.html" title="Jinx::CsvIO::Joiner (class)">Joiner</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="MMM_MM_MAP-constant" class="">MMM_MM_MAP =
          <div class="docstring">
  <div class="discussion">
    <p>
3-letter months => month sequence hash.
</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='lbrack token'>[</span><span class='string val'>'jan'</span><span class='comma token'>,</span> <span class='string val'>'feb'</span><span class='comma token'>,</span> <span class='string val'>'mar'</span><span class='comma token'>,</span> <span class='string val'>'apr'</span><span class='comma token'>,</span> <span class='string val'>'may'</span><span class='comma token'>,</span> <span class='string val'>'jun'</span><span class='comma token'>,</span> <span class='string val'>'jul'</span><span class='comma token'>,</span> <span class='string val'>'aug'</span><span class='comma token'>,</span> <span class='string val'>'sep'</span><span class='comma token'>,</span> <span class='string val'>'oct'</span><span class='comma token'>,</span> <span class='string val'>'nov'</span><span class='comma token'>,</span> <span class='string val'>'dec'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_compact_hash_with_index identifier id'>to_compact_hash_with_index</span> <span class='do do kw'>do</span>
</pre></dd>
      
        <dt id="DateMatcher-constant" class="">DateMatcher =
          <div class="docstring">
  <div class="discussion">
    <p>
DateMatcher relaxes the FasterCSV DateMatcher to allow dd/mm/yyyy dates.
</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='regexp val'>/ \A(?: (\w+,?\s+)?\w+\s+\d{1,2},?\s+\d{2,4} | \d{1,2}-\w{3}-\d{2,4} | \d{4}[-\/]\d{1,2}[-\/]\d{1,2} | \d{1,2}[-\/]\d{1,2}[-\/]\d{2,4} )\z /</span><span class='x identifier id'>x</span>
</pre></dd>
      
        <dt id="DD_MMM_YYYY_RE-constant" class="">DD_MMM_YYYY_RE =
          
        </dt>
        <dd><pre class="code"><span class='regexp val'>/^(\d{1,2})-([[:alpha:]]{3})-(\d{2,4})$/</span>
</pre></dd>
      
    </dl>
  


  
  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#accessors-instance_method" title="#accessors (instance method)">- (&lt;Symbol&gt;) <strong>accessors</strong> </a>
    

    
      (also: #headers)
    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
The CSV field value accessor.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#field_names-instance_method" title="#field_names (instance method)">- (&lt;String&gt;) <strong>field_names</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
The CSV field names.
</p>
</div></span>
  
</li>

    
  </ul>


  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#foreach-class_method" title="foreach (class method)">+ (Object) <strong>foreach</strong>(file, opts = nil) {|row| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Opens the given CSV file and calls <span class='object_link'><a href="#each-instance_method" title="Jinx::CsvIO#each (method)">CsvIO#each</a></span> with the given block.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#join-class_method" title="join (class method)">+ (Object) <strong>join</strong>(source, target = nil, output = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Joins the source to the target and writes the output.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#open-class_method" title="open (class method)">+ (Object) <strong>open</strong>(dev, opts = nil) {|csvio| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Opens the CSV file and calls the given block with this CsvIO as the
argument.
</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#accessor-instance_method" title="#accessor (instance method)">- (Object) <strong>accessor</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#close-instance_method" title="#close (instance method)">- (Object) <strong>close</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Closes the CSV file.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each-instance_method" title="#each (instance method)">- (Object) <strong>each</strong> {|row| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Iterates over each CSV row, yielding a row for each iteration.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (CsvIO) <strong>initialize</strong>(dev, opts = nil) {|value, info| ... }</a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Creates a new CsvIO for the specified source file.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#readline-instance_method" title="#readline (instance method)">- (Object) <strong>readline</strong> </a>
    

    
      (also: #shift, #next)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
The next CSV row.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write-instance_method" title="#write (instance method)">- (Object) <strong>write</strong>(row) </a>
    

    
      (also: #&lt;&lt;)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Writes the given row to the CSV file.
</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Jinx::CsvIO (class)">CsvIO</a></span></tt>) <strong>initialize</strong>(dev, opts = nil) {|value, info| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Creates a new CsvIO for the specified source file. If a converter block is
given, then it is added to the CSV converters list.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>IO</tt>)</span>
      
      
        <span class='name'>dev</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the CSV file or stream to open
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the open options
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <h3>Options Hash (<tt>opts</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:mode</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the input mode (default <tt>r</tt>)
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:headers</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the input field headers
</p>
</div>
        </tr>
      
    </ul>
  
<h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
        <span class='type'>(<tt>value</tt>, <tt>info</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
converts the input value
</p>
</div>
      
    </li>
  
</ul>
<h3>Yield Parameters:</h3>
<ul class="yieldparam">
  
    <li>
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <span class='name'>value</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the input value
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'></span>
      
      
        <span class='name'>info</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the current field&#8217;s FasterCSV FieldInfo metadata
</p>
</div>
      
    </li>
  
</ul>
<h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
if the input is nil
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 79</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='dev identifier id'>dev</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='converter identifier id'>converter</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;CSV input argument is missing&quot;</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='dev identifier id'>dev</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='comment val'># the CSV file open mode</span>
  <span class='mode identifier id'>mode</span> <span class='assign token'>=</span> <span class='Options constant id'>Options</span><span class='dot token'>.</span><span class='get identifier id'>get</span><span class='lparen token'>(</span><span class='symbol val'>:mode</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='comma token'>,</span> <span class='string val'>'r'</span><span class='rparen token'>)</span>
  <span class='comment val'># the CSV headers option; can be boolean or array</span>
  <span class='hdr_opt identifier id'>hdr_opt</span> <span class='assign token'>=</span> <span class='Options constant id'>Options</span><span class='dot token'>.</span><span class='get identifier id'>get</span><span class='lparen token'>(</span><span class='symbol val'>:headers</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
  <span class='comment val'># there is a header record by default for an input CSV file</span>
  <span class='hdr_opt identifier id'>hdr_opt</span> <span class='opasgn op'>||=</span> <span class='true true kw'>true</span> <span class='if if_mod kw'>if</span> <span class='mode identifier id'>mode</span> <span class='match op'>=~</span> <span class='regexp val'>/^r/</span>
  <span class='comment val'># make parent directories if necessary for an output CSV file</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='makedirs identifier id'>makedirs</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='dev identifier id'>dev</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='String constant id'>String</span> <span class='eq op'>==</span> <span class='dev identifier id'>dev</span> <span class='and and kw'>and</span> <span class='mode identifier id'>mode</span> <span class='match op'>=~</span> <span class='regexp val'>/^w/</span>
  <span class='comment val'># if headers aren't given, then convert the input CSV header record names to underscore symbols</span>
  <span class='hdr_cvtr identifier id'>hdr_cvtr</span> <span class='assign token'>=</span> <span class='symbol val'>:symbol</span> <span class='unless unless_mod kw'>unless</span> <span class='Enumerable constant id'>Enumerable</span> <span class='eqq op'>===</span> <span class='hdr_opt identifier id'>hdr_opt</span>
  <span class='comment val'># make a custom converter</span>
  <span class='custom identifier id'>custom</span> <span class='assign token'>=</span> <span class='Proc constant id'>Proc</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='info identifier id'>info</span><span class='bitor op'>|</span> <span class='convert identifier id'>convert</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='info identifier id'>info</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='converter identifier id'>converter</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='comment val'># collect the options</span>
  <span class='csv_opts identifier id'>csv_opts</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hdr_opt identifier id'>hdr_opt</span><span class='comma token'>,</span> <span class='symbol val'>:header_converters</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hdr_cvtr identifier id'>hdr_cvtr</span><span class='comma token'>,</span> <span class='symbol val'>:return_headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='symbol val'>:write_headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='symbol val'>:converters</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='custom identifier id'>custom</span><span class='rbrace token'>}</span>
  <span class='comment val'># Make the parent directory if necessary.</span>
  <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mkdir_p identifier id'>mkdir_p</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='dev identifier id'>dev</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='dev identifier id'>dev</span> <span class='and and kw'>and</span> <span class='mode identifier id'>mode</span> <span class='nmatch op'>!~</span> <span class='regexp val'>/^r/</span>
  <span class='comment val'># open the CSV file</span>
  <span class='@csv ivar id'>@csv</span> <span class='assign token'>=</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='dev identifier id'>dev</span> <span class='integer val'>? </span><span class='FasterCSV constant id'>FasterCSV</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='dev identifier id'>dev</span><span class='comma token'>,</span> <span class='mode identifier id'>mode</span><span class='comma token'>,</span> <span class='csv_opts identifier id'>csv_opts</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='FasterCSV constant id'>FasterCSV</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dev identifier id'>dev</span><span class='comma token'>,</span> <span class='csv_opts identifier id'>csv_opts</span><span class='rparen token'>)</span>
  <span class='comment val'># the header =&gt; field name hash:</span>
  <span class='comment val'># if the header option is set to true, then read the input header line.</span>
  <span class='comment val'># otherwise, parse an empty string which mimics an input header line.</span>
  <span class='hdr_row identifier id'>hdr_row</span> <span class='assign token'>=</span> <span class='case case kw'>case</span> <span class='hdr_opt identifier id'>hdr_opt</span>
  <span class='when when kw'>when</span> <span class='true true kw'>true</span> <span class='then then kw'>then</span>
    <span class='@csv ivar id'>@csv</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span>
  <span class='when when kw'>when</span> <span class='Enumerable constant id'>Enumerable</span> <span class='then then kw'>then</span>
    <span class='string val'>''</span><span class='dot token'>.</span><span class='parse_csv identifier id'>parse_csv</span><span class='lparen token'>(</span><span class='symbol val'>:headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hdr_opt identifier id'>hdr_opt</span><span class='comma token'>,</span> <span class='symbol val'>:header_converters</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:symbol</span><span class='comma token'>,</span> <span class='symbol val'>:return_headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='Jinx constant id'>Jinx</span><span class='dot token'>.</span><span class='fail identifier id'>fail</span><span class='lparen token'>(</span><span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;CSV headers option value not supported: #{hdr_opt}&quot;</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='comment val'># The field value accessors consist of the header row headers converted to a symbol.</span>
  <span class='@accessors ivar id'>@accessors</span> <span class='assign token'>=</span> <span class='hdr_row identifier id'>hdr_row</span><span class='dot token'>.</span><span class='headers identifier id'>headers</span>
  <span class='comment val'># The field names consist of the header row values.</span>
  <span class='@field_names ivar id'>@field_names</span> <span class='assign token'>=</span> <span class='@accessors ivar id'>@accessors</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='sym identifier id'>sym</span><span class='bitor op'>|</span> <span class='hdr_row identifier id'>hdr_row</span><span class='lbrack token'>[</span><span class='sym identifier id'>sym</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='comment val'># the header name =&gt; symbol map</span>
  <span class='@hdr_sym_hash ivar id'>@hdr_sym_hash</span> <span class='assign token'>=</span> <span class='hdr_row identifier id'>hdr_row</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span><span class='dot token'>.</span><span class='invert identifier id'>invert</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="accessors-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="accessors-instance_method">
  
    - (<tt>&lt;Symbol&gt;</tt>) <strong>accessors</strong>  <span class="extras">(readonly)</span>
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='headers-instance_method'>headers</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
The CSV field value accessor
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>&lt;Symbol&gt;</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the CSV field value accessor
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 26</span>

<span class='def def kw'>def</span> <span class='accessors identifier id'>accessors</span>
  <span class='@accessors ivar id'>@accessors</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="field_names-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="field_names-instance_method">
  
    - (<tt>&lt;String&gt;</tt>) <strong>field_names</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
The CSV field names
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>&lt;String&gt;</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the CSV field names
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 23</span>

<span class='def def kw'>def</span> <span class='field_names identifier id'>field_names</span>
  <span class='@field_names ivar id'>@field_names</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="foreach-class_method">
  
    + (<tt>Object</tt>) <strong>foreach</strong>(file, opts = nil) {|row| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Opens the given CSV file and calls <span class='object_link'><a href="#each-instance_method" title="Jinx::CsvIO#each (method)">#each</a></span> with the given block.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>IO</tt>)</span>
      
      
        <span class='name'>dev</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the CSV file or stream to open
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the open options
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <h3>Options Hash (<tt>opts</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:mode</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the input mode (default <tt>r</tt>)
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:headers</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the input field headers
</p>
</div>
        </tr>
      
    </ul>
  
<h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
        <span class='type'>(<tt>row</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the block to execute on the row
</p>
</div>
      
    </li>
  
</ul>
<h3>Yield Parameters:</h3>
<ul class="yieldparam">
  
    <li>
      
        <span class='type'>(<tt>{Symbol =&gt; Object}</tt>)</span>
      
      
        <span class='name'>row</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the field symbol => value hash
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 52</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='foreach identifier id'>foreach</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='csvio identifier id'>csvio</span><span class='bitor op'>|</span> <span class='csvio identifier id'>csvio</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="join-class_method">
  
    + (<tt>Object</tt>) <strong>join</strong>(source, target = nil, output = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Joins the source to the target and writes the output. The match is on all
fields held in common. If there is more than one match, then all but the
first match has empty values for the merged fields. Both files must be
sorted in order of the common fields, sequenced by their occurence in the
source header.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>IO</tt>)</span>
      
      
        <span class='name'>source</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the join source
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>IO</tt>)</span>
      
      
        <span class='name'>target</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the join target
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>IO</tt>, <tt>nil</tt>)</span>
      
      
        <span class='name'>output</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the output file name or device (default stdout)
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 64</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='output identifier id'>output</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='Joiner constant id'>Joiner</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='output identifier id'>output</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="open-class_method">
  
    + (<tt>Object</tt>) <strong>open</strong>(dev, opts = nil) {|csvio| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Opens the CSV file and calls the given block with this CsvIO as the
argument.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>IO</tt>)</span>
      
      
        <span class='name'>dev</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the CSV file or stream to open
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the open options
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <h3>Options Hash (<tt>opts</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:mode</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the input mode (default <tt>r</tt>)
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:headers</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the input field headers
</p>
</div>
        </tr>
      
    </ul>
  
<h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
        <span class='type'>(<tt>csvio</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the optional block to execute
</p>
</div>
      
    </li>
  
</ul>
<h3>Yield Parameters:</h3>
<ul class="yieldparam">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Jinx::CsvIO (class)">CsvIO</a></span></tt>)</span>
      
      
        <span class='name'>csvio</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the open CSVIO instance
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37
38
39
40
41
42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 35</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='dev identifier id'>dev</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='csvio identifier id'>csvio</span> <span class='assign token'>=</span> <span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dev identifier id'>dev</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='block_given? fid id'>block_given?</span> <span class='then then kw'>then</span>
    <span class='begin begin kw'>begin</span>
      <span class='yield yield kw'>yield</span> <span class='csvio identifier id'>csvio</span>
    <span class='ensure ensure kw'>ensure</span>
      <span class='csvio identifier id'>csvio</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="accessor-instance_method">
  
    - (<tt>Object</tt>) <strong>accessor</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <span class='name'>header</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the CSV field header name
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <span class='name'>the</span>
      
      
      
        &mdash;
        <div class='inline'><p>
header accessor method
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


125
126
127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 125</span>

<span class='def def kw'>def</span> <span class='accessor identifier id'>accessor</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='@hdr_sym_hash ivar id'>@hdr_sym_hash</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="close-instance_method">
  
    - (<tt>Object</tt>) <strong>close</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Closes the CSV file.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


119
120
121</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 119</span>

<span class='def def kw'>def</span> <span class='close identifier id'>close</span>
  <span class='@csv ivar id'>@csv</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="each-instance_method">
  
    - (<tt>Object</tt>) <strong>each</strong> {|row| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Iterates over each CSV row, yielding a row for each iteration.
</p>


  </div>
</div>
<div class="tags">
  <h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
        <span class='type'>(<tt>row</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
processes the CSV row
</p>
</div>
      
    </li>
  
</ul>
<h3>Yield Parameters:</h3>
<ul class="yieldparam">
  
    <li>
      
        <span class='type'>(<tt>FasterCSV::Row</tt>)</span>
      
      
        <span class='name'>row</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the CSV row
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


133
134
135</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 133</span>

<span class='def def kw'>def</span> <span class='each identifier id'>each</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='@csv ivar id'>@csv</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="readline-instance_method">
  
    - (<tt>Object</tt>) <strong>readline</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='shift-instance_method'>shift</span>, <span id='next-instance_method'>next</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
The next CSV row
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'></span>
      
      
      
      
        
        <div class='inline'><p>
the next CSV row
</p>
</div>
      
    </li>
  
</ul>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="#each-instance_method" title="Jinx::CsvIO#each (method)">#each</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 139</span>

<span class='def def kw'>def</span> <span class='readline identifier id'>readline</span>
  <span class='@csv ivar id'>@csv</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="write-instance_method">
  
    - (<tt>Object</tt>) <strong>write</strong>(row) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='<<-instance_method'>&lt;&lt;</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
Writes the given row to the CSV file.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>{Symbol =&gt; Object}</tt>)</span>
      
      
        <span class='name'>row</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the input row
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


150
151
152
153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/csvio.rb', line 150</span>

<span class='def def kw'>def</span> <span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='row identifier id'>row</span><span class='rparen token'>)</span>
  <span class='@csv ivar id'>@csv</span> <span class='lshft op'>&lt;&lt;</span> <span class='row identifier id'>row</span>
  <span class='@csv ivar id'>@csv</span><span class='dot token'>.</span><span class='flush identifier id'>flush</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Feb 16 18:54:02 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.8.6).
</div>

  </body>
</html>