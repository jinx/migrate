<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: Jinx::CsvIO::Joiner</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (J)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../Jinx.html" title="Jinx (module)">Jinx</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../CsvIO.html" title="Jinx::CsvIO (class)">CsvIO</a></span></span>
     &raquo; 
    <span class="title">Joiner</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Jinx::CsvIO::Joiner
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Jinx::CsvIO::Joiner</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">Enumerable</dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/jinx/csv/joiner.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Merges two CSV files on common fields.
</p>


  </div>
</div>
<div class="tags">
  
</div>

  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compare-instance_method" title="#compare (instance method)">- (-1, ...) <strong>compare</strong>(source, target) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Compares the given source and target buffers with result as follows:
</p>
<ul>
<li><p>
If source and target are nil, then nil
</p>
</li>
<li><p>
If source is nil and target is not nil, then -1
</p>
</li>
<li><p>
If target is nil and source is not nil, then 1
</p>
</li>
<li><p>
Otherwise, the pair-wise comparison of the source and target keys.
</p>
</li>
</ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Joiner) <strong>initialize</strong>(source, target = nil, output = nil) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
A new instance of Joiner.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#join-instance_method" title="#join (instance method)">- (Object) <strong>join</strong> {|rec| ... }</a>
    

    
      (also: #each)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Joins the source to the target and writes the output.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#look_ahead-instance_method" title="#look_ahead (instance method)">- (Buffer<sup>?</sup>) <strong>look_ahead</strong>(csvio, buf = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
The modified look-ahead, or nil if end of file.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shift-instance_method" title="#shift (instance method)">- (Buffer<sup>?</sup>) <strong>shift</strong>(csvio, buf = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Reads a record into the given buffers.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shift%3F-instance_method" title="#shift? (instance method)">- (Boolean) <strong>shift?</strong>(buf, other, order) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns whether to shift the given buffer as follows:
</p>
<ul>
<li><p>
If the buffer precedes the other buffer, then true.
</p>
</li>
</ul>
</div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Jinx::CsvIO::Joiner (class)">Joiner</a></span></tt>) <strong>initialize</strong>(source, target = nil, output = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
A new instance of Joiner
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>IO</tt>)</span>
      
      
        <span class='name'>source</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the join source
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>IO</tt>)</span>
      
      
        <span class='name'>target</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the join target (default stdin)
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>IO</tt>, <tt>nil</tt>)</span>
      
      
        <span class='name'>output</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the output file name or device (default stdout)
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


10
11
12
13
14</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/joiner.rb', line 10</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='output identifier id'>output</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='@source ivar id'>@source</span> <span class='assign token'>=</span> <span class='source identifier id'>source</span>
  <span class='@target ivar id'>@target</span> <span class='assign token'>=</span> <span class='target identifier id'>target</span> <span class='orop op'>||</span> <span class='STDIN constant id'>STDIN</span>
  <span class='@output ivar id'>@output</span> <span class='assign token'>=</span> <span class='output identifier id'>output</span> <span class='orop op'>||</span> <span class='STDOUT constant id'>STDOUT</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="compare-instance_method">
  
    - (<tt>-1</tt>, ...) <strong>compare</strong>(source, target) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Compares the given source and target buffers with result as follows:
</p>
<ul>
<li><p>
If source and target are nil, then nil
</p>
</li>
<li><p>
If source is nil and target is not nil, then -1
</p>
</li>
<li><p>
If target is nil and source is not nil, then 1
</p>
</li>
<li><p>
Otherwise, the pair-wise comparison of the source and target keys
</p>
</li>
</ul>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>:key</tt>)</span>
      
      
        <span class='name'>the</span>
      
      
      
        &mdash;
        <div class='inline'><p>
key holder
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>-1</tt>, <tt>0</tt>, <tt>1</tt>, <tt>nil</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the comparison result
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


147
148
149
150
151
152
153
154
155
156
157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/joiner.rb', line 147</span>

<span class='def def kw'>def</span> <span class='compare identifier id'>compare</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='target identifier id'>target</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='integer val'>? </span><span class='nil nil kw'>nil</span> <span class='colon op'>:</span> <span class='integer val'>1</span> <span class='if if_mod kw'>if</span> <span class='source identifier id'>source</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='return return kw'>return</span> <span class='integer val'>-1</span> <span class='if if_mod kw'>if</span> <span class='target identifier id'>target</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='source identifier id'>source</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='v1 identifier id'>v1</span><span class='comma token'>,</span> <span class='i identifier id'>i</span><span class='bitor op'>|</span>
    <span class='v2 identifier id'>v2</span> <span class='assign token'>=</span> <span class='target identifier id'>target</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span>
    <span class='next next kw'>next</span> <span class='if if_mod kw'>if</span> <span class='v1 identifier id'>v1</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='and and kw'>and</span> <span class='v2 identifier id'>v2</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='return return kw'>return</span> <span class='integer val'>-1</span> <span class='if if_mod kw'>if</span> <span class='v1 identifier id'>v1</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='return return kw'>return</span> <span class='integer val'>1</span> <span class='if if_mod kw'>if</span> <span class='v2 identifier id'>v2</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='cmp identifier id'>cmp</span> <span class='assign token'>=</span> <span class='v1 identifier id'>v1</span> <span class='cmp op'>&lt;=&gt;</span> <span class='v2 identifier id'>v2</span>
    <span class='return return kw'>return</span> <span class='cmp identifier id'>cmp</span> <span class='unless unless_mod kw'>unless</span> <span class='cmp identifier id'>cmp</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
  <span class='end end kw'>end</span>
  <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="join-instance_method">
  
    - (<tt>Object</tt>) <strong>join</strong> {|rec| ... }
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='each-instance_method'>each</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
Joins the source to the target and writes the output. The match is on all
fields held in common. If there is more than one match, then all but the
first match has empty values for the merged fields. Both files must be
sorted in order of the common fields, sequenced by their occurence in the
source header.
</p>
<p>
If an output argument is given, then the joined record is written to the
output. If a block is given, then the block is called on each record prior
to writing the record to the output.
</p>


  </div>
</div>
<div class="tags">
  <h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
        <span class='type'>(<tt>rec</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
process the output
</p>
</div>
      
    </li>
  
</ul>
<h3>Yield Parameters:</h3>
<ul class="yieldparam">
  
    <li>
      
        <span class='type'>(<tt>FasterCSV::Record</tt>)</span>
      
      
        <span class='name'>rec</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the output record
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33
34
35
36
37
38
39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/joiner.rb', line 27</span>

<span class='def def kw'>def</span> <span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='CsvIO constant id'>CsvIO</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='@target ivar id'>@target</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='tgt identifier id'>tgt</span><span class='bitor op'>|</span>
    <span class='CsvIO constant id'>CsvIO</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='@source ivar id'>@source</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='src identifier id'>src</span><span class='bitor op'>|</span>
      <span class='@common ivar id'>@common</span> <span class='assign token'>=</span> <span class='src identifier id'>src</span><span class='dot token'>.</span><span class='accessors identifier id'>accessors</span> <span class='bitand op'>&amp;</span> <span class='tgt identifier id'>tgt</span><span class='dot token'>.</span><span class='accessors identifier id'>accessors</span>
      <span class='hdrs identifier id'>hdrs</span> <span class='assign token'>=</span> <span class='src identifier id'>src</span><span class='dot token'>.</span><span class='field_names identifier id'>field_names</span> <span class='bitor op'>|</span> <span class='tgt identifier id'>tgt</span><span class='dot token'>.</span><span class='field_names identifier id'>field_names</span>
      <span class='CsvIO constant id'>CsvIO</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='@output ivar id'>@output</span><span class='comma token'>,</span> <span class='symbol val'>:mode</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'w'</span><span class='comma token'>,</span> <span class='symbol val'>:headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hdrs identifier id'>hdrs</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='out identifier id'>out</span><span class='bitor op'>|</span>
        <span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='src identifier id'>src</span><span class='comma token'>,</span> <span class='tgt identifier id'>tgt</span><span class='comma token'>,</span> <span class='out identifier id'>out</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
    
  <span class='alias alias kw'>alias</span> <span class='symbol val'>:each</span> <span class='symbol val'>:join</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="look_ahead-instance_method">
  
    - (<tt>Buffer</tt><sup>?</sup>) <strong>look_ahead</strong>(csvio, buf = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
The modified look-ahead, or nil if end of file
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../CsvIO.html" title="Jinx::CsvIO (class)">CsvIO</a></span></tt>)</span>
      
      
        <span class='name'>csvio</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the CSV file stream
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Buffer</tt>, <tt>nil</tt>)</span>
      
      
        <span class='name'>the</span>
      
      
      
        &mdash;
        <div class='inline'><p>
look-ahead buffer
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Buffer</tt>, <tt>nil</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the modified look-ahead, or nil if end of file
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133
134
135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/joiner.rb', line 131</span>

<span class='def def kw'>def</span> <span class='look_ahead identifier id'>look_ahead</span><span class='lparen token'>(</span><span class='csvio identifier id'>csvio</span><span class='comma token'>,</span> <span class='buf identifier id'>buf</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rec identifier id'>rec</span> <span class='assign token'>=</span> <span class='csvio identifier id'>csvio</span><span class='dot token'>.</span><span class='next identifier id'>next</span> <span class='orop op'>||</span> <span class='return return kw'>return</span>
  <span class='buf identifier id'>buf</span> <span class='opasgn op'>||=</span> <span class='Buffer constant id'>Buffer</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='record identifier id'>record</span> <span class='assign token'>=</span> <span class='rec identifier id'>rec</span>
  <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='@common ivar id'>@common</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='bitor op'>|</span> <span class='rec identifier id'>rec</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='buf identifier id'>buf</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="shift-instance_method">
  
    - (<tt>Buffer</tt><sup>?</sup>) <strong>shift</strong>(csvio, buf = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Reads a record into the given buffers.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../CsvIO.html" title="Jinx::CsvIO (class)">CsvIO</a></span></tt>)</span>
      
      
        <span class='name'>the</span>
      
      
      
        &mdash;
        <div class='inline'><p>
open CSV stream to read
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Buffer</tt>, <tt>nil</tt>)</span>
      
      
        <span class='name'>cbuf</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the current record buffer
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Buffer</tt>, <tt>nil</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the next current buffer, or nil if end of file
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


114
115
116
117
118
119
120
121
122
123
124
125
126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/joiner.rb', line 114</span>

<span class='def def kw'>def</span> <span class='shift identifier id'>shift</span><span class='lparen token'>(</span><span class='csvio identifier id'>csvio</span><span class='comma token'>,</span> <span class='buf identifier id'>buf</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='buf identifier id'>buf</span> <span class='then then kw'>then</span>
    <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='lookahead identifier id'>lookahead</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='else else kw'>else</span>
    <span class='comment val'># prime the look-ahead</span>
    <span class='buf identifier id'>buf</span> <span class='assign token'>=</span> <span class='Buffer constant id'>Buffer</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='look_ahead identifier id'>look_ahead</span><span class='lparen token'>(</span><span class='csvio identifier id'>csvio</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='shift identifier id'>shift</span><span class='lparen token'>(</span><span class='csvio identifier id'>csvio</span><span class='comma token'>,</span> <span class='buf identifier id'>buf</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='record identifier id'>record</span> <span class='assign token'>=</span> <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='lookahead identifier id'>lookahead</span><span class='dot token'>.</span><span class='record identifier id'>record</span>
  <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='lookahead identifier id'>lookahead</span><span class='dot token'>.</span><span class='key identifier id'>key</span>
  <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='lookahead identifier id'>lookahead</span> <span class='assign token'>=</span> <span class='look_ahead identifier id'>look_ahead</span><span class='lparen token'>(</span><span class='csvio identifier id'>csvio</span><span class='comma token'>,</span> <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='lookahead identifier id'>lookahead</span><span class='rparen token'>)</span>
  <span class='buf identifier id'>buf</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="shift?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>shift?</strong>(buf, other, order) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns whether to shift the given buffer as follows:
</p>
<ul>
<li><p>
If the buffer precedes the other buffer, then true.
</p>
</li>
<li><p>
If the buffer succeeds the other buffer, then false.
</p>
</li>
<li><p>
Otherwise, if the lookahead record has the same key as the buffer record
then true.
</p>
</li>
<li><p>
Otherwise, if the other lookahead record has a different key than the other
record, then true.
</p>
</li>
</ul>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Buffer</tt>)</span>
      
      
        <span class='name'>buf</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the record buffer to check
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Buffer</tt>)</span>
      
      
        <span class='name'>other</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the other record buffer
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>-1</tt>, <tt>0</tt>, <tt>1</tt>)</span>
      
      
        <span class='name'>order</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the buffer comparison
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
whether to shift the buffer
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100
101
102
103
104
105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jinx/csv/joiner.rb', line 98</span>

<span class='def def kw'>def</span> <span class='shift? fid id'>shift?</span><span class='lparen token'>(</span><span class='buf identifier id'>buf</span><span class='comma token'>,</span> <span class='other identifier id'>other</span><span class='comma token'>,</span> <span class='order identifier id'>order</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='order identifier id'>order</span>
  <span class='when when kw'>when</span> <span class='integer val'>-1</span> <span class='then then kw'>then</span>
    <span class='true true kw'>true</span>
  <span class='when when kw'>when</span> <span class='integer val'>1</span> <span class='then then kw'>then</span>
    <span class='false false kw'>false</span>
  <span class='when when kw'>when</span> <span class='integer val'>0</span> <span class='then then kw'>then</span>
    <span class='compare identifier id'>compare</span><span class='lparen token'>(</span><span class='buf identifier id'>buf</span><span class='comma token'>,</span> <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='lookahead identifier id'>lookahead</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='or or kw'>or</span> <span class='compare identifier id'>compare</span><span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='comma token'>,</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='lookahead identifier id'>lookahead</span><span class='rparen token'>)</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Feb 16 18:54:03 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.8.6).
</div>

  </body>
</html>